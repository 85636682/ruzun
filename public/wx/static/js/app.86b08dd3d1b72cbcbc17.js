webpackJsonp([19,17],{0:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}var u=n(33),a=o(u),i=n(150),s=o(i),r=n(149),c=o(r),d=n(132),l=o(d),f=n(104),p=o(f),h=n(35),m=o(h),v=n(39),g=o(v),_=n(151),y=n(26),T=o(y),S=n(41),O=o(S);a["default"].config.debug=!0;var w={API:"http://ruzun.jiancan.me/api/v1"};a["default"].use(c["default"]),a["default"].use(s["default"]),a["default"].use(g["default"],w),a["default"].use(l["default"],{error:"",loading:"","try":3});var b=new s["default"]({});b.beforeEach(function(t){if(t.to.auth){var e=localStorage.getItem("ruzun_user_token");e&&null!==e||t.redirect("/signin")}p["default"].attach(document.body),t.next()});var I=a["default"].extend(n(133));(0,m["default"])(b),(0,_.sync)(T["default"],b),O["default"].init(a["default"]),b.start(I,"#app")},4:function(t,e,n){"use strict";function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e["default"]=t,e}Object.defineProperty(e,"__esModule",{value:!0}),e.setAuthorized=e.setCurrentUser=e.signout=e.signin=e.hideToast=e.showToast=void 0;var u=n(19),a=o(u);e.showToast=function(t,e){var n=t.dispatch;n(a.SHOW_TOAST,e)},e.hideToast=function(t){var e=t.dispatch;e(a.HIDE_TOAST)},e.signin=function(t,e){var n=t.dispatch;n(a.SIGN_IN,e)},e.signout=function(t){var e=t.dispatch;e(a.SIGN_OUT)},e.setCurrentUser=function(t,e){var n=t.dispatch;n(a.SET_CURRENT_USER,e)},e.setAuthorized=function(t,e){var n=t.dispatch;n(a.SET_AUTHORIZED,e)}},5:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function u(t){return t.json()}function a(t){if(t.status>=200&&t.status<300)return t;if(401===t.status){var e=new Error("验证错误，请退出重新登录！");throw e.res=t,e.type="Authorization",e}var n=new Error(t.statusText);throw n.res=t,n.type="http",n}function i(t,e){return e?t+" "+e:t}function s(t,e){var n=arguments.length<=2||void 0===arguments[2]?"":arguments[2];return t=y+t,e&&(t+="?"+v["default"].stringify(e)),fetch(t,{headers:{Authorization:i("User",n)}}).then(a).then(u)}function r(t,e){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],o=arguments.length<=3||void 0===arguments[3]?"":arguments[3];return t=y+t,fetch(t,{method:e,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:i("User",o)},body:(0,h["default"])(n)}).then(a).then(u)}function c(t,e){var n=arguments.length<=2||void 0===arguments[2]?"":arguments[2];return r(t,"POST",e,n)}function d(t,e){var n=arguments.length<=2||void 0===arguments[2]?"":arguments[2];return r(t,"PUT",e,n)}function l(t,e){var n=arguments.length<=2||void 0===arguments[2]?"":arguments[2];return r(t,"PATCH",e,n)}function f(t,e){var n=arguments.length<=2||void 0===arguments[2]?"":arguments[2];return r(t,"DELETE",e,n)}Object.defineProperty(e,"__esModule",{value:!0});var p=n(20),h=o(p);e.get=s,e.post=c,e.put=d,e.patch=l,e.del=f;var m=n(105),v=o(m),g=n(34),_=o(g);n(155);var y=_["default"].domain+_["default"].apiPath},16:function(t,e,n){"use strict";function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e["default"]=t,e}function u(t){return f.get("/users/"+t)}function a(t){return f.get("/users/auth",{},t)}function i(t){return f.get("/users/sundry",{},t)}function s(t){return f.post("/users",t)}function r(t,e,n){return f.put("/users/"+t,e,n)}function c(t,e,n){return f.get("/wechat/get_user_avatar_from_wechat",{user_id:t,media_id:e},n)}function d(t){return f.post("/sessions",t)}Object.defineProperty(e,"__esModule",{value:!0}),e.getUser=u,e.getCurrentUser=a,e.getSundry=i,e.createUser=s,e.updateUser=r,e.updateAvatar=c,e.signIn=d;var l=n(5),f=o(l)},19:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.ROUTE_CHANGED="router/ROUTE_CHANGED",e.SHOW_TOAST="SHOW_TOAST",e.HIDE_TOAST="HIDE_TOAST",e.SIGN_IN="SIGN_IN",e.SIGN_OUT="SIGN_OUT",e.SET_AUTHORIZED="SET_AUTHORIZED"},26:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var u,a=n(27),i=o(a),s=n(33),r=o(s),c=n(152),d=o(c),l=n(153),f=o(l),p=n(40),h=o(p),m=n(19);r["default"].use(d["default"]),r["default"].config.debug=!0;var v=!1,g={toast:{show:!1,type:"text",message:"",time:2e3}},_=(u={},(0,i["default"])(u,m.SHOW_TOAST,function(t,e){var n=arguments.length<=2||void 0===arguments[2]?"text":arguments[2],o=arguments.length<=3||void 0===arguments[3]?2e3:arguments[3];t.toast.show=!0,t.toast.message=e,t.toast.type=n,t.toast.time=o}),(0,i["default"])(u,m.HIDE_TOAST,function(t){t.toast.show=!1}),u);e["default"]=new d["default"].Store({state:g,mutations:_,modules:{users:h["default"]},strict:v,middlewares:v?[(0,f["default"])()]:[]})},34:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]={domain:"http://ruzun.jiancan.me",apiPath:"/api/v1"}},35:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=function(t){t.map({"*":{component:function(t){n.e(1,function(e){var n=[e(32)];t.apply(null,n)}.bind(this))}},"/":{name:"home",component:function(t){n.e(0,function(e){var n=[e(31)];t.apply(null,n)}.bind(this))}},"/home":{name:"home",component:function(t){n.e(0,function(e){var n=[e(31)];t.apply(null,n)}.bind(this))}},"/signin":{name:"signin",component:function(t){n.e(1,function(e){var n=[e(32)];t.apply(null,n)}.bind(this))}},"/signup":{name:"signup",component:function(t){n.e(16,function(e){var n=[e(140)];t.apply(null,n)}.bind(this))}},"/users/:uid/edit/":{name:"usersedit",component:function(t){n.e(15,function(e){var n=[e(148)];t.apply(null,n)}.bind(this))},auth:!0},"/personal":{name:"personal",component:function(t){n.e(2,function(e){var n=[e(138)];t.apply(null,n)}.bind(this))}},"/teams":{name:"teams",component:function(t){n.e(11,function(e){var n=[e(142)];t.apply(null,n)}.bind(this))}},"/teams/:tid":{name:"team",component:function(t){n.e(5,function(e){var n=[e(145)];t.apply(null,n)}.bind(this))}},"/teams/new":{name:"teamsnew",component:function(t){n.e(8,function(e){var n=[e(143)];t.apply(null,n)}.bind(this))},auth:!0},"/teams/:tid/edit":{name:"teamsedit",component:function(t){n.e(12,function(e){var n=[e(141)];t.apply(null,n)}.bind(this))},auth:!0},"/teams/:tid/playeds":{name:"teamsplayeds",component:function(t){n.e(7,function(e){var n=[e(144)];t.apply(null,n)}.bind(this))}},"/teams/:tid/users":{name:"teamsusers",component:function(t){n.e(6,function(e){var n=[e(146)];t.apply(null,n)}.bind(this))}},"/games":{name:"games",component:function(t){n.e(3,function(e){var n=[e(135)];t.apply(null,n)}.bind(this))}},"/games/:gid":{name:"game",component:function(t){n.e(13,function(e){var n=[e(137)];t.apply(null,n)}.bind(this))}},"/games/:gid/constitution":{name:"constitution",component:function(t){n.e(14,function(e){var n=[e(136)];t.apply(null,n)}.bind(this))}},"/games/:gid/playeds":{name:"playeds",component:function(t){n.e(9,function(e){var n=[e(139)];t.apply(null,n)}.bind(this))}},"/playeds/:pid/techstats":{name:"techstats",component:function(t){n.e(10,function(e){var n=[e(147)];t.apply(null,n)}.bind(this))}},"/discover":{name:"discover",component:function(t){n.e(4,function(e){var n=[e(134)];t.apply(null,n)}.bind(this))}}})}},39:function(t,e){"use strict";t.exports=function(t,e){t.mixin({created:function(){this.$config=e}})}},40:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var u,a=n(27),i=o(a),s=n(19),r={isLogged:!1,token:"",user:{}},c=(u={},(0,i["default"])(u,s.SIGN_IN,function(t,e){t.isLogged=!0,t.user=e,t.token=e.token,localStorage.setItem("ruzun_user_token",e.token)}),(0,i["default"])(u,s.SIGN_OUT,function(t){t.isLogged=!1,t.user={},localStorage.removeItem("ruzun_user_token")}),(0,i["default"])(u,s.SET_CURRENT_USER,function(t,e){t.user=e}),(0,i["default"])(u,s.SET_AUTHORIZED,function(t,e){t.isLogged=!0,t.token=localStorage.getItem("ruzun_user_token")}),u);e["default"]={state:r,mutations:c}},41:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]={init:function(t){t.http.get("http://ruzun.jiancan.me/api/v1/wechat/sign_package.json?request_url="+location.href.split("#")[0]).then(function(t){"string"==typeof t.data&&(t.data=JSON.parse(t.data));var e=t.data;window.wx.config({appId:e.appId,timestamp:e.timestamp,nonceStr:e.nonceStr,signature:e.signature,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","hideMenuItems","showMenuItems","hideAllNonBaseMenuItem","showAllNonBaseMenuItem","translateVoice","startRecord","stopRecord","onRecordEnd","playVoice","pauseVoice","stopVoice","uploadVoice","downloadVoice","chooseImage","previewImage","uploadImage","downloadImage","getNetworkType","openLocation","getLocation","hideOptionMenu","showOptionMenu","closeWindow","scanQRCode","chooseWXPay","openProductSpecificView","addCard","chooseCard","openCard"]})})}}},42:function(t,e,n){"use strict";function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e["default"]=t,e}function u(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(26),i=u(a),s=n(154),r=u(s),c=n(4),d=n(16),l=o(d);e["default"]={store:i["default"],vuex:{getters:{toast:function(t){return t.toast},isLogged:function(t){return t.users.isLogged}},actions:{showToast:c.showToast,hideToast:c.hideToast,setCurrentUser:c.setCurrentUser,setAuthorized:c.setAuthorized}},computed:{showToast:{get:function(){return this.toast.show},set:function(t){t||this.hideToast()}}},components:{Toast:r["default"]},created:function(){var t=this;if(!this.isLogged){var e=localStorage.getItem("ruzun_user_token");null!==e&&(this.setAuthorized(e),l.getCurrentUser(e).then(function(e){t.setCurrentUser(e.user)})["catch"](function(t){console.log(t)}))}}}},88:function(t,e){},114:function(t,e){t.exports=" <div id=main> <router-view></router-view> <toast :show.sync=showToast :type=toast.type>{{toast.message}}</toast> </div> "},133:function(t,e,n){var o,u;n(88),o=n(42),u=n(114),t.exports=o||{},t.exports.__esModule&&(t.exports=t.exports["default"]),u&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=u)}});
//# sourceMappingURL=app.86b08dd3d1b72cbcbc17.js.map